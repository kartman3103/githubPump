package tests

import org.junit.Assert
import org.junit.Test
import org.junit.runner.RunWith
import org.springframework.beans.factory.annotation.Autowired
import org.springframework.boot.test.context.SpringBootTest
import org.springframework.test.context.junit4.SpringRunner

import pump.Application
import pump.json.JsonParser
import pump.model.Repository

@RunWith(SpringRunner::class)
@SpringBootTest(classes = arrayOf(Application::class))
class JsonParserTest {
    @Autowired
    lateinit var jsonParser : JsonParser

    @Test
    fun testRepositoryParse() {
        val testString = "{\"id\":90038728,\"name\":\"sportstat\",\"full_name\":\"WonderfulFalcon/sportstat\",\"owner\":{\"login\":\"WonderfulFalcon\",\"id\":10142398,\"avatar_url\":\"https://avatars0.githubusercontent.com/u/10142398?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/WonderfulFalcon\",\"html_url\":\"https://github.com/WonderfulFalcon\",\"followers_url\":\"https://api.github.com/users/WonderfulFalcon/followers\",\"following_url\":\"https://api.github.com/users/WonderfulFalcon/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/WonderfulFalcon/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/WonderfulFalcon/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/WonderfulFalcon/subscriptions\",\"organizations_url\":\"https://api.github.com/users/WonderfulFalcon/orgs\",\"repos_url\":\"https://api.github.com/users/WonderfulFalcon/repos\",\"events_url\":\"https://api.github.com/users/WonderfulFalcon/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/WonderfulFalcon/received_events\",\"type\":\"User\",\"site_admin\":false},\"private\":false,\"html_url\":\"https://github.com/WonderfulFalcon/sportstat\",\"description\":null,\"fork\":false,\"url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat\",\"forks_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/forks\",\"keys_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/teams\",\"hooks_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/hooks\",\"issue_events_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/events\",\"assignees_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/tags\",\"blobs_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/languages\",\"stargazers_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/stargazers\",\"contributors_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/contributors\",\"subscribers_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/subscribers\",\"subscription_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/subscription\",\"commits_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/merges\",\"archive_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/downloads\",\"issues_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/WonderfulFalcon/sportstat/deployments\",\"created_at\":\"2017-05-02T13:49:26Z\",\"updated_at\":\"2018-03-15T09:12:39Z\",\"pushed_at\":\"2018-03-15T17:55:52Z\",\"git_url\":\"git://github.com/WonderfulFalcon/sportstat.git\",\"ssh_url\":\"git@github.com:WonderfulFalcon/sportstat.git\",\"clone_url\":\"https://github.com/WonderfulFalcon/sportstat.git\",\"svn_url\":\"https://github.com/WonderfulFalcon/sportstat\",\"homepage\":null,\"size\":3304,\"stargazers_count\":1,\"watchers_count\":1,\"language\":\"Kotlin\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":true,\"has_pages\":false,\"forks_count\":1,\"mirror_url\":null,\"archived\":false,\"open_issues_count\":7,\"license\":null,\"forks\":1,\"open_issues\":7,\"watchers\":1,\"default_branch\":\"master\",\"network_count\":1,\"subscribers_count\":3}"

        val repository : Repository = jsonParser.parseRepository(testString)

        Assert.assertEquals(90038722, repository.id)
        Assert.assertEquals("sportstat", repository.name)
    }
}